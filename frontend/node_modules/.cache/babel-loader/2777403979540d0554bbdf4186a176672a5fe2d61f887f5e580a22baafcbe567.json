{"ast":null,"code":"import _defineProperty from\"B:/dev/3DModelViewer/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"B:/dev/3DModelViewer/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"B:/dev/3DModelViewer/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{Route,Routes,useNavigate}from\"react-router-dom\";import Wellcome from\"./Wellcome\";import*as Auth from\"../utils/Auth\";import{CurrentUserContext}from\"../contexts/CurrentUserContext\";import Api from\"../utils/Api\";import CardPage from\"./CardPage\";import AuthForm from\"./AuthForm\";import Main from\"./Main\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),isError=_useState2[0],setError=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),messageError=_useState4[0],setMessageError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoggedIn=_useState6[0],setLoggedIn=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isAuth=_useState8[0],setAuth=_useState8[1];var _useState9=useState([1,2,3,4,5,6,7,8,9]),_useState10=_slicedToArray(_useState9,2),cards=_useState10[0],setCards=_useState10[1];var _useState11=useState({}),_useState12=_slicedToArray(_useState11,2),currentUser=_useState12[0],setCurrentUser=_useState12[1];var navigate=useNavigate();var api=new Api({baseUrl:\"https://api.thewargas.nomoredomains.monster\",headers:{Authorization:\"Bearer \".concat(localStorage.getItem(\"jwt\")),\"Content-Type\":\"application/json\"}});useEffect(function(){if(isLoggedIn){Promise.all([api.getInitialInfo(),api.getInitialCards()]).then(function(_ref){var _ref2=_slicedToArray(_ref,2),userData=_ref2[0],cardsData=_ref2[1];setCurrentUser(userData);console.log(currentUser.email);// setCards(cardsData.reverse());\n}).catch(function(error){console.log(error);});}},[isLoggedIn]);function validateInputs(e){if(!e.target.validity.valid){setError(_objectSpread(_objectSpread({},isError),{},_defineProperty({},e.target.name,true)));setMessageError(_objectSpread(_objectSpread({},messageError),{},_defineProperty({},e.target.name,e.target.validationMessage)));}else{setError(_objectSpread(_objectSpread({},isError),{},_defineProperty({},e.target.name,false)));setMessageError(_objectSpread(_objectSpread({},messageError),{},_defineProperty({},e.target.name,\"\")));}}function handleRegister(inputs){Auth.register(inputs.email,inputs.login,inputs.password).then(function(){setAuth(true);setTimeout(function(){navigate(\"/sign-in\",{replace:true});},2000);}).catch(function(error){setAuth(false);console.log(error);});}function handleAuthorize(inputs){Auth.authorize(inputs.login,inputs.password).then(function(res){if(res.token){localStorage.setItem(\"jwt\",res.token);setLoggedIn(true);setAuth(false);navigate(\"/models\",{replace:true});}}).catch(function(error){console.log(error);});}var handleCardClick=function handleCardClick(card){// setSelectedCard(card);\n// setImagePopupOpen(true);\n};return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Wellcome,{})}),/*#__PURE__*/_jsx(Route,{path:\"/sign-up\",element:/*#__PURE__*/_jsx(AuthForm,{onValidation:validateInputs,isError:isError,messageError:messageError,title:\"Создать аккаунт\",button:\"Создать аккаунт\",paragraph:\"Уже есть аккаунт\",link:\"Войти\",isAuth:isAuth,onSubmit:handleRegister,register:\"true\",route:\"/sign-in\"})}),/*#__PURE__*/_jsx(Route,{path:\"/sign-in\",element:/*#__PURE__*/_jsx(AuthForm,{onValidation:validateInputs,isError:isError,messageError:messageError,title:\"Вход\",button:\"Войти\",paragraph:\"Нет аккаунта?\",link:\"Зарегистрироваться\",isAuth:isAuth,onSubmit:handleAuthorize,register:false,route:\"/sign-up\"})}),/*#__PURE__*/_jsx(Route,{path:\"/models\",element:/*#__PURE__*/_jsx(Main,{cards:cards,onValidation:validateInputs,isError:isError,messageError:messageError})}),cards.map(function(card){return/*#__PURE__*/_jsx(Route,{path:\"/models/\".concat(card),element:/*#__PURE__*/_jsx(CardPage,{card:card})});})]})});}export default App;","map":{"version":3,"names":["useState","useEffect","Route","Routes","useNavigate","Wellcome","Auth","CurrentUserContext","Api","CardPage","AuthForm","Main","jsx","_jsx","jsxs","_jsxs","App","_useState","_useState2","_slicedToArray","isError","setError","_useState3","_useState4","messageError","setMessageError","_useState5","_useState6","isLoggedIn","setLoggedIn","_useState7","_useState8","isAuth","setAuth","_useState9","_useState10","cards","setCards","_useState11","_useState12","currentUser","setCurrentUser","navigate","api","baseUrl","headers","Authorization","concat","localStorage","getItem","Promise","all","getInitialInfo","getInitialCards","then","_ref","_ref2","userData","cardsData","console","log","email","catch","error","validateInputs","e","target","validity","valid","_objectSpread","_defineProperty","name","validationMessage","handleRegister","inputs","register","login","password","setTimeout","replace","handleAuthorize","authorize","res","token","setItem","handleCardClick","card","Provider","value","children","path","element","onValidation","title","button","paragraph","link","onSubmit","route","map"],"sources":["B:/dev/3DModelViewer/frontend/src/components/App.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { Route, Routes, useNavigate } from \"react-router-dom\";\r\nimport Wellcome from \"./Wellcome\";\r\nimport * as Auth from \"../utils/Auth\";\r\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext\";\r\nimport Api from \"../utils/Api\";\r\nimport CardPage from \"./CardPage\";\r\n\r\nimport AuthForm from \"./AuthForm\";\r\nimport Main from \"./Main\";\r\n\r\nfunction App() {\r\n  const [isError, setError] = useState({});\r\n  const [messageError, setMessageError] = useState({});\r\n\r\n  const [isLoggedIn, setLoggedIn] = useState(false);\r\n  const [isAuth, setAuth] = useState(false);\r\n\r\n  const [cards, setCards] = useState([1, 2, 3, 4, 5, 6, 7, 8, 9]);\r\n  const [currentUser, setCurrentUser] = useState({});\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const api = new Api({\r\n    baseUrl: \"https://api.thewargas.nomoredomains.monster\",\r\n    headers: {\r\n      Authorization: `Bearer ${localStorage.getItem(\"jwt\")}`,\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isLoggedIn) {\r\n      Promise.all([api.getInitialInfo(), api.getInitialCards()])\r\n\r\n        .then(([userData, cardsData]) => {\r\n          setCurrentUser(userData);\r\n          console.log(currentUser.email);\r\n          // setCards(cardsData.reverse());\r\n        })\r\n\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n    }\r\n  }, [isLoggedIn]);\r\n\r\n  function validateInputs(e) {\r\n    if (!e.target.validity.valid) {\r\n      setError({\r\n        ...isError,\r\n        [e.target.name]: true,\r\n      });\r\n      setMessageError({\r\n        ...messageError,\r\n        [e.target.name]: e.target.validationMessage,\r\n      });\r\n    } else {\r\n      setError({\r\n        ...isError,\r\n        [e.target.name]: false,\r\n      });\r\n      setMessageError({\r\n        ...messageError,\r\n        [e.target.name]: \"\",\r\n      });\r\n    }\r\n  }\r\n\r\n  function handleRegister(inputs) {\r\n    Auth.register(inputs.email, inputs.login, inputs.password)\r\n      .then(() => {\r\n        setAuth(true);\r\n        setTimeout(() => {\r\n          navigate(\"/sign-in\", { replace: true });\r\n        }, 2000);\r\n      })\r\n      .catch((error) => {\r\n        setAuth(false);\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  function handleAuthorize(inputs) {\r\n    Auth.authorize(inputs.login, inputs.password)\r\n      .then((res) => {\r\n        if (res.token) {\r\n          localStorage.setItem(\"jwt\", res.token);\r\n          setLoggedIn(true);\r\n          setAuth(false);\r\n          navigate(\"/models\", { replace: true });\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  const handleCardClick = (card) => {\r\n    // setSelectedCard(card);\r\n    // setImagePopupOpen(true);\r\n  };\r\n\r\n  return (\r\n    <CurrentUserContext.Provider value={currentUser}>\r\n      <Routes>\r\n        <Route path=\"/\" element={<Wellcome />} />\r\n        <Route\r\n          path=\"/sign-up\"\r\n          element={\r\n            <AuthForm\r\n              onValidation={validateInputs}\r\n              isError={isError}\r\n              messageError={messageError}\r\n              title={\"Создать аккаунт\"}\r\n              button={\"Создать аккаунт\"}\r\n              paragraph={\"Уже есть аккаунт\"}\r\n              link={\"Войти\"}\r\n              isAuth={isAuth}\r\n              onSubmit={handleRegister}\r\n              register=\"true\"\r\n              route={\"/sign-in\"}\r\n            />\r\n          }\r\n        />\r\n        <Route\r\n          path=\"/sign-in\"\r\n          element={\r\n            <AuthForm\r\n              onValidation={validateInputs}\r\n              isError={isError}\r\n              messageError={messageError}\r\n              title={\"Вход\"}\r\n              button={\"Войти\"}\r\n              paragraph={\"Нет аккаунта?\"}\r\n              link={\"Зарегистрироваться\"}\r\n              isAuth={isAuth}\r\n              onSubmit={handleAuthorize}\r\n              register={false}\r\n              route={\"/sign-up\"}\r\n            />\r\n          }\r\n        />\r\n        <Route\r\n          path=\"/models\"\r\n          element={\r\n            <Main\r\n              cards={cards}\r\n              onValidation={validateInputs}\r\n              isError={isError}\r\n              messageError={messageError}\r\n            />\r\n          }\r\n        />\r\n        {cards.map((card) => {\r\n          return (\r\n            <Route\r\n              path={`/models/${card}`}\r\n              element={<CardPage card={card} />}\r\n            />\r\n          );\r\n        })}\r\n      </Routes>\r\n    </CurrentUserContext.Provider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}